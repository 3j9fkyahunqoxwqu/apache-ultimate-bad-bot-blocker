####################################################################################
# The Apache Ultimate Bot Blocker
# **********************************************************************************
# Created by: https://github.com/mitchellkrogza
#
# PLEASE READ the full Readme at
# https://github.com/mitchellkrogza/apache-ultimate-bad-bot-blocker/blob/master/README.md
#
# WARNING:
# ********
# Please understand why you are using this before you even use this.
# Please do not simply copy and paste without understanding what this is doing.
#
# MONITOR WHAT YOU ARE DOING:
# ***************************
# MAKE SURE to monitor your web site logs after implementing this. I suggest you first
# load this into one site and monitor it for any possible false positives before putting
# this into production on all your web sites.
#
# CONFIGURATION EXAMPLE:
# **********************
# Include this in the beginning of a directory block just after your opening
# Options statements and before the rest of your host config example below
#
# ---------------------------------------------------------------------------------
# <VirtualHost *:443>
# .....
# .....
#<Directory "/var/www/mywebsite/htdocs/">
#Options +Includes
#Options +FollowSymLinks -Indexes
#Include /etc/apache2/custom.d/globalblacklist.conf <<<<<< This needs to be added
# ......
# ......
# BEGIN WordPress
#<IfModule mod_rewrite.c>
# ---------------------------------------------------------------------------------
####################################################################################

# FIRST BLOCK BY USER-AGENT STRINGS
# *********************************

# PLEASE TEST !!!
# ***************
# ALWAYS test any User-Agent Strings you add here to make sure you have it right
# Use a Chrome Extension called "User-Agent Switcher for Chrome" where you can create your
# own custom lists of User-Agent and test them easily against your rules below.

# Some Good Bots We Know
# This is why it is important to monitor your log files
# see - https://github.com/google/google-http-java-client
BrowserMatchNoCase "Google-HTTP-Java-Client" good_bot

# KNOWN VULNERABILITY SCANNERS
BrowserMatchNoCase "Acunetix" bad_bot
BrowserMatchNoCase "FHscan" bad_bot
BrowserMatchNoCase "masscan" bad_bot
BrowserMatchNoCase "probethenet" bad_bot
BrowserMatchNoCase "Scanbot" bad_bot

# BAIDU
# Aggressive Chinese Search Engine
BrowserMatchNoCase "Baiduspider" bad_bot

# YANDEX
# Russian Search Engine - I don't block this
# Very popular Russian Search Engine - Your call
#BrowserMatchNoCase "Yandex" bad_bot

# ALEXA
# Said to be good for SEO ranking factors
# Some dispute it and block them out - up to you.
# I do not by default block them out.
#BrowserMatchNoCase "Alexa" bad_bot

# CURL
# If you regularly use CURL for testing stuff then don't
# uncomment the following line
#BrowserMatchNoCase "curl" bad_bot

# Other Known Bad Bots
BrowserMatchNoCase "80legs" bad_bot
BrowserMatchNoCase "360Spider" bad_bot
BrowserMatchNoCase "Aboundex" bad_bot
BrowserMatchNoCase "Abonti" bad_bot
BrowserMatchNoCase "AIBOT" bad_bot
BrowserMatchNoCase "Alexibot" bad_bot
BrowserMatchNoCase "Alligator" bad_bot
BrowserMatchNoCase "AllSubmitter" bad_bot
BrowserMatchNoCase "aipbot" bad_bot
BrowserMatchNoCase "Anarchie" bad_bot
BrowserMatchNoCase "Apexoo" bad_bot
BrowserMatchNoCase "asterias" bad_bot
BrowserMatchNoCase "ASPSeek" bad_bot
BrowserMatchNoCase "attach" bad_bot
BrowserMatchNoCase "autoemailspider" bad_bot
BrowserMatchNoCase "BackDoorBot" bad_bot
BrowserMatchNoCase "BackStreet" bad_bot
BrowserMatchNoCase "BackWeb" bad_bot
BrowserMatchNoCase "BadAss" bad_bot
BrowserMatchNoCase "BatchFTP" bad_bot
BrowserMatchNoCase "Bigfoot" bad_bot
BrowserMatchNoCase "Black.Hole" bad_bot
BrowserMatchNoCase "BlowFish" bad_bot
BrowserMatchNoCase "Blow" bad_bot
BrowserMatchNoCase "BotALot" bad_bot
BrowserMatchNoCase "Buddy" bad_bot
BrowserMatchNoCase "BuiltBotTough" bad_bot
BrowserMatchNoCase "BunnySlippers" bad_bot
BrowserMatchNoCase "BBBike" bad_bot
BrowserMatchNoCase "BlackWidow" bad_bot
BrowserMatchNoCase "craftbot@yahoo.com" bad_bot
BrowserMatchNoCase "Cegbfeieh" bad_bot
BrowserMatchNoCase "CheeseBot" bad_bot
BrowserMatchNoCase "CherryPicker" bad_bot
BrowserMatchNoCase "ChinaClaw" bad_bot
BrowserMatchNoCase "Custo" bad_bot
BrowserMatchNoCase "Cogentbot" bad_bot
BrowserMatchNoCase "CPython" bad_bot
BrowserMatchNoCase "Collector" bad_bot
BrowserMatchNoCase "Copier" bad_bot
BrowserMatchNoCase "CopyRightCheck" bad_bot
BrowserMatchNoCase "cosmos" bad_bot
BrowserMatchNoCase "Crescent" bad_bot
BrowserMatchNoCase "CSHttp" bad_bot
BrowserMatchNoCase "Custo" bad_bot
BrowserMatchNoCase "Demon" bad_bot
BrowserMatchNoCase "Devil" bad_bot
BrowserMatchNoCase "DIIbot" bad_bot
BrowserMatchNoCase "DISCo" bad_bot
BrowserMatchNoCase "DittoSpyder" bad_bot
BrowserMatchNoCase "Download Demon" bad_bot
BrowserMatchNoCase "Download.Demon" bad_bot
BrowserMatchNoCase "Download.Devil" bad_bot
BrowserMatchNoCase "Download.Wonder" bad_bot
BrowserMatchNoCase "dragonfly" bad_bot
BrowserMatchNoCase "Drip" bad_bot
BrowserMatchNoCase "EasyDL" bad_bot
BrowserMatchNoCase "ebingbong" bad_bot
BrowserMatchNoCase "eCatch" bad_bot
BrowserMatchNoCase "EirGrabber" bad_bot
BrowserMatchNoCase "EmailCollector" bad_bot
BrowserMatchNoCase "EmailSiphon" bad_bot
BrowserMatchNoCase "EmailWolf" bad_bot
BrowserMatchNoCase "EroCrawler" bad_bot
BrowserMatchNoCase "EyeNetIE" bad_bot
BrowserMatchNoCase "Exabot" bad_bot
BrowserMatchNoCase "Express" bad_bot
BrowserMatchNoCase "Express WebPictures" bad_bot
BrowserMatchNoCase "Extractor" bad_bot
BrowserMatchNoCase "ExtractorPro" bad_bot
BrowserMatchNoCase "EyeNetIE" bad_bot
BrowserMatchNoCase "FlashGet" bad_bot
BrowserMatchNoCase "FHscan" bad_bot
BrowserMatchNoCase "flunky" bad_bot
BrowserMatchNoCase "Foobot" bad_bot
BrowserMatchNoCase "freeuploader" bad_bot
BrowserMatchNoCase "FrontPage" bad_bot
BrowserMatchNoCase "GalaxyBot" bad_bot
BrowserMatchNoCase "GetRight" bad_bot
BrowserMatchNoCase "GetWeb!" bad_bot
BrowserMatchNoCase "Go!Zilla" bad_bot
BrowserMatchNoCase "Go-Ahead-Got-It" bad_bot
BrowserMatchNoCase "gotit" bad_bot
BrowserMatchNoCase "Grabber" bad_bot
BrowserMatchNoCase "GrabNet" bad_bot
BrowserMatchNoCase "Grafula" bad_bot
BrowserMatchNoCase "Harvest" bad_bot
BrowserMatchNoCase "hloader" bad_bot
BrowserMatchNoCase "HMView" bad_bot
BrowserMatchNoCase "HTTrack" bad_bot
BrowserMatchNoCase "HTMLParser" bad_bot
BrowserMatchNoCase "humanlinks" bad_bot
BrowserMatchNoCase "iblog" bad_bot
BrowserMatchNoCase "IlseBot" bad_bot
BrowserMatchNoCase "imagefetch" bad_bot
BrowserMatchNoCase "Image Stripper" bad_bot
BrowserMatchNoCase "Image Sucker" bad_bot
BrowserMatchNoCase "Indy Library" bad_bot
BrowserMatchNoCase "InfoNaviRobot" bad_bot
BrowserMatchNoCase "InfoTekies" bad_bot
BrowserMatchNoCase "Intelliseek" bad_bot
BrowserMatchNoCase "InterGET" bad_bot
BrowserMatchNoCase "Internet Ninja" bad_bot
BrowserMatchNoCase "Iria" bad_bot
BrowserMatchNoCase "Jakarta" bad_bot
BrowserMatchNoCase "Jakarta Commons" bad_bot
# JAVA
# Here we search for any Agent Strings beginning with Java (not wildcarded) as it picks 
# up an official Google Java Client listed above.
# Once again (I will DRUM this into your head) MONITOR MONITOR MONITOR YOUR LOGS !!!!
BrowserMatchNoCase "^Java" bad_bot
BrowserMatchNoCase "JennyBot" bad_bot
BrowserMatchNoCase "JetCar" bad_bot
BrowserMatchNoCase "JikeSpider" bad_bot
BrowserMatchNoCase "JOC" bad_bot
BrowserMatchNoCase "JOC Web Spider" bad_bot
BrowserMatchNoCase "JustView" bad_bot
BrowserMatchNoCase "Jyxobot" bad_bot
BrowserMatchNoCase "larbin" bad_bot
BrowserMatchNoCase "LeechFTP" bad_bot
BrowserMatchNoCase "Linkwalker" bad_bot
BrowserMatchNoCase "libcurl" bad_bot
BrowserMatchNoCase "LWP::Simple" bad_bot
BrowserMatchNoCase "lwp-request" bad_bot
# MEGAINDEX
# Have found this new crawler using up extensive amounts of bandwidth across multiple
# web sites. They look small fry and are not in the leagues of Google or Bing they seem
# to also charge fees for backlink reports see - https://megaindex.com/tarifs
BrowserMatchNoCase "MegaIndex" bad_bot
BrowserMatchNoCase "Mass Downloader" bad_bot
BrowserMatchNoCase "Microsoft Data Access" bad_bot
BrowserMatchNoCase "Microsoft URL Control" bad_bot
BrowserMatchNoCase "MIDown tool" bad_bot
BrowserMatchNoCase "Mister PiX" bad_bot
BrowserMatchNoCase "MS Web Services Client Protocol" bad_bot
BrowserMatchNoCase "nameprotect" bad_bot
BrowserMatchNoCase "Navroad" bad_bot
BrowserMatchNoCase "NearSite" bad_bot
BrowserMatchNoCase "NetAnts" bad_bot
BrowserMatchNoCase "NetSpider" bad_bot
BrowserMatchNoCase "Net Vampire" bad_bot
BrowserMatchNoCase "NetZIP" bad_bot
BrowserMatchNoCase "Octopus" bad_bot
BrowserMatchNoCase "Offline Explorer" bad_bot
BrowserMatchNoCase "Offline Navigator" bad_bot
BrowserMatchNoCase "PageGrabber" bad_bot
BrowserMatchNoCase "Papa Foto" bad_bot
BrowserMatchNoCase "pavuk" bad_bot
BrowserMatchNoCase "pcBrowser" bad_bot
BrowserMatchNoCase "PECL::HTTP" bad_bot
BrowserMatchNoCase "PECL::HTTP" bad_bot
BrowserMatchNoCase "POE-Component-Client-HTTP" bad_bot
BrowserMatchNoCase "PycURL" bad_bot
BrowserMatchNoCase "RealDownload" bad_bot
BrowserMatchNoCase "ReGet" bad_bot
BrowserMatchNoCase "RPT-HTTPClient" bad_bot
BrowserMatchNoCase "searchestate" bad_bot
BrowserMatchNoCase "SiteSnagger" bad_bot
BrowserMatchNoCase "SmartDownload" bad_bot
BrowserMatchNoCase "Snoopy" bad_bot
BrowserMatchNoCase "spammen" bad_bot
BrowserMatchNoCase "Sucker" bad_bot
BrowserMatchNoCase "SiteSucker" bad_bot
BrowserMatchNoCase "SiteSucker" bad_bot
BrowserMatchNoCase "SuperBot" bad_bot
BrowserMatchNoCase "SuperHTTP" bad_bot
BrowserMatchNoCase "Surfbot" bad_bot
BrowserMatchNoCase "tAkeOut" bad_bot
BrowserMatchNoCase "Teleport Pro" bad_bot
BrowserMatchNoCase "TurnitinBot" bad_bot
BrowserMatchNoCase "VB Project" bad_bot
BrowserMatchNoCase "VoidEYE" bad_bot
BrowserMatchNoCase "Web Image Collector" bad_bot
BrowserMatchNoCase "Web Sucker" bad_bot
BrowserMatchNoCase "WebAuto" bad_bot
BrowserMatchNoCase "WebCopier" bad_bot
BrowserMatchNoCase "WebFetch" bad_bot
BrowserMatchNoCase "WebGo IS" bad_bot
BrowserMatchNoCase "WebLeacher" bad_bot
BrowserMatchNoCase "WebReaper" bad_bot
BrowserMatchNoCase "WebSauger" bad_bot
BrowserMatchNoCase "Website eXtractor" bad_bot
BrowserMatchNoCase "Website Quester" bad_bot
BrowserMatchNoCase "WebStripper" bad_bot
BrowserMatchNoCase "WebWhacker" bad_bot
BrowserMatchNoCase "WebZIP" bad_bot
BrowserMatchNoCase "Wget" bad_bot
BrowserMatchNoCase "Widow" bad_bot
BrowserMatchNoCase "WWWOFFLE" bad_bot
BrowserMatchNoCase "WWW::Mechanize" bad_bot
BrowserMatchNoCase "Xaldon WebSpider" bad_bot
BrowserMatchNoCase "Xenu" bad_bot
BrowserMatchNoCase "Zeus" bad_bot

# NEXT WE BLOCK BY SPECIFIC REFERER STRINGS
# *****************************************
# Referers are often used to spam or make your site appear to be spam
# They can be very bad for your SEO if not monitored -- DID I mention you need to 
# be monitoring your logs frequently so that you know who is trying to do what
# Referers can also result in high bounce rates on your sites by sending fake traffic
#
# Once Again we use a NoCase Apache variable here so its not case sensitive

# ADD Any Referers to this alphabetical block - other specific blocks ie. Semalt
# have their own custom blocks which are easier to maintain.
#
# PLEASE TEST !!!!
# *****************
# ALWAYS test referers that you add. This is done manually as follows
# curl --referer http://getmyads24.com http://www.yourdomain.com/
# This uses curl to send the referer string to your site and you should see an immediate
# 403 Forbidden Error
# I also include any sites that hotlink images from my sites into the list below

SetEnvIfNoCase Referer "buttons-for-website.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.?)?38ha(-|.).*$" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?214jaluwobapef.cf" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?beachpics.net" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?clgrmgds.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?curatorimages.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?decorationspcs.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?freeuploader.ml" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?forumprofi.de" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?gallerily.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?getmyads24.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?goodsgram.net" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?ideaspicz.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?izito.co.za" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?lottospring.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?megaindex.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?megaindex.ru" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?millionare.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?pizza-tycoon.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?pizza-imperia.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?razyboard.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?savetubevideo.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?spammen.de" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?wesharepics.info" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?zapmeta.co.za" spam_ref=1




# SEMALT BLOCK - Read following articles
# https://www.incapsula.com/blog/semalt-botnet-spam.html
# http://www.kymodo.com.au/what-is-semalt-doing-on-your-website/
# https://www.ohow.co/what-is-semalt-com-and-semalt-media-referral-analytics/
# http://www.forthea.com/block-semalt-crawler/
#
# I actually registered on their site to see what SEO services and reports they
# offer and within 3 hours I had a phone call from Florida in the US with a sales
# guy hassling me and telling me how wonderful they were and how they would guarantee
# me a number one place on Google ... ha ha !!! Goodbye you are BLOCKED NOW !!!

SetEnvIfNoCase Referer "^(http|https)?://(www.)?best-seo-solution.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?best-seo-offer.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?fix-website-errors.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?free-video-tool.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?keywords-monitoring-your-success.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?keywords-monitoring-success.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?rankings-analytics.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?responsive-test.net" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?seo-2-0.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?seo-patform.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?semalt.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?semalt.media" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?semalt.design" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?semaltmedia.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?success-seo.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?top1-seo-service.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?videos-for-your-business.com" spam_ref=1
SetEnvIfNoCase Referer "^(http|https)?://(www.)?video--production.com" spam_ref=1

# More SEMALT bots will be added here as I find them


Order Allow,Deny
Allow from all

# Cyveillance
deny from 38.100.19.8/29
deny from 38.100.21.0/24
deny from 38.100.41.64/26
deny from 38.105.71.0/25
deny from 38.105.83.0/27
deny from 38.112.21.140/30
deny from 38.118.42.32/29
deny from 65.213.208.128/27
deny from 65.222.176.96/27
deny from 65.222.185.72/29

deny from 63.144.0.0/13
deny from 65.112.0.0/12

# BERKELEY SCANNER
# ****************
# The Berkeley University has a scanner testing all over the web sending a complex
# payload an expecting a reply from servers who are infected or who just respond to such
# a payload. The payload looks similar to this
# "$\xC9\xE1\xDC\x9B+\x8F\x1C\xE71\x99\xA8\xDB6\x1E#\xBB\x19#Hx\xA7\xFD\x0F9-"
# and is sometime VERY long. You may have noticed this in your logs.
# I support research projects and all my servers respond with an error to this type of
# string so I do not block them but if you want to block just uncomment the following line 
# or email them asking them not to scan your server. They do respond.
# Visit http://169.229.3.91/ for more info
#deny from 169.229.3.91

deny from env=bad_bot
deny from env=spam_ref
# END --- rest of your server config will continue after this block
